Description,Target,Expression
#,, annotate persons table after import
is_k12,is_k12,"persons['schg'].between(1,5)"
is_univeristy,is_university,"persons['schg'].between(6,7)"
is_predrive,is_predrive,persons['agep'] <= 15
is_drive,is_drive,persons['agep'] > 15
is_student,is_student,"persons['schg'].between(1,7)"
school_segment k12_predrive,school_segment,"np.where((is_k12 & is_predrive), 1, 0)"
school_segment k12_drive,school_segment,"np.where((is_k12 & is_drive), 2, school_segment)"
school_segment university,school_segment,"np.where(is_university, 3, school_segment)"
is_working_age,_is_working_age,"persons.agep>=16"
is_fulltime_worker,is_fulltime_worker,"((_is_working_age) & (persons['wkhp'] >=35) & (persons['wkw']>=1) & (persons['wkw']<=4) & (~persons['esr'].isin([3,6])))"
is_worker,is_worker,"df['pecasOcc'].isin([1,2,3,4,5])"
Work Segment - White Collar Worker,work_segment,"np.where(df['pecasOcc']==1, 1, 0)"
Work Segment - Service Worker,work_segment,"np.where(df['pecasOcc']==2, 2, work_segment)"
Work Segment - Health Worker,work_segment,"np.where(df['pecasOcc']==3, 3, work_segment)"
Work Segment - Retail or Food Worker,work_segment,"np.where(df['pecasOcc']==4, 4, work_segment)"
Work Segment - Blue Collar Worker,work_segment,"np.where(df['pecasOcc']==5, 5, work_segment)"